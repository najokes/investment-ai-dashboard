<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ—Ö–∫–æ–Ω—Ç—É—Ä–Ω–∞—è AI-—Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è–º–∏ | –û–û–û ¬´–ú–æ–±–∞–π–ª –ü–∞—Ä–∫ –ò–¢¬ª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #8B0000 0%, #600000 100%);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            display: grid;
            grid-template-columns: 400px 1fr 400px;
            min-height: 95vh;
            border: 1px solid rgba(139, 0, 0, 0.2);
        }
        
        @media (max-width: 1400px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
        
        header {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #8B0000 0%, #600000 100%);
            color: white;
            padding: 25px 40px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .header-content {
            position: relative;
            z-index: 2;
        }
        
        .header-bg {
            position: absolute;
            top: 0;
            right: 0;
            height: 100%;
            opacity: 0.1;
            font-size: 150px;
            display: flex;
            align-items: center;
            padding-right: 40px;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: white;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
            color: #ffcccb;
            margin-bottom: 15px;
        }
        
        .left-panel, .right-panel {
            background: #f8f9fa;
            padding: 25px;
            height: 100%;
            overflow-y: auto;
        }
        
        .left-panel {
            border-right: 1px solid #dee2e6;
        }
        
        .right-panel {
            border-left: 1px solid #dee2e6;
        }
        
        .panel-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 5px 15px rgba(139, 0, 0, 0.1);
        }
        
        .section-title {
            color: #8B0000;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #8B0000;
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .company-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .company-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .company-logo {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #8B0000 0%, #600000 100%);
            color: white;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            border: 2px solid white;
            box-shadow: 0 5px 15px rgba(139, 0, 0, 0.2);
        }
        
        .inn-input-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .inn-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.95rem;
            background: white;
            color: #333;
            transition: all 0.3s;
        }
        
        .inn-input:focus {
            outline: none;
            border-color: #8B0000;
            box-shadow: 0 0 0 3px rgba(139, 0, 0, 0.1);
        }
        
        .search-btn {
            background: linear-gradient(135deg, #8B0000 0%, #600000 100%);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .search-btn:hover {
            background: linear-gradient(135deg, #600000 0%, #8B0000 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 0, 0, 0.3);
        }
        
        .export-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .export-btn {
            flex: 1;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .export-btn:hover {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(44, 62, 80, 0.3);
        }
        
        .export-btn.pdf {
            background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%);
        }
        
        .export-btn.excel {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        }
        
        .ai-recommendation-badge {
            background: linear-gradient(135deg, #8B0000 0%, #600000 100%);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-left: 10px;
        }
        
        .recommendation-card {
            background: white;
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 15px;
            border-left: 6px solid;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.2s;
        }
        
        .recommendation-card:hover {
            transform: translateX(5px);
        }
        
        .recommendation-card.high {
            border-left-color: #c0392b;
            background: linear-gradient(to right, rgba(192, 57, 43, 0.02), white);
        }
        
        .recommendation-card.medium {
            border-left-color: #e67e22;
            background: linear-gradient(to right, rgba(230, 126, 34, 0.02), white);
        }
        
        .recommendation-card.low {
            border-left-color: #f39c12;
            background: linear-gradient(to right, rgba(243, 156, 18, 0.02), white);
        }
        
        .recommendation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .recommendation-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .recommendation-priority {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            color: white;
        }
        
        .priority-high { background: #c0392b; }
        .priority-medium { background: #e67e22; }
        .priority-low { background: #f39c12; }
        
        .recommendation-metrics {
            display: flex;
            gap: 20px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .metric-tag {
            background: #f8f9fa;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid #e0e0e0;
        }
        
        .metric-tag strong {
            color: #8B0000;
        }
        
        .recommendation-description {
            color: #555;
            line-height: 1.6;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }
        
        .implementation-steps {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
        }
        
        .implementation-steps h5 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .implementation-steps ul {
            list-style-type: none;
            padding-left: 0;
        }
        
        .implementation-steps li {
            padding: 6px 0;
            padding-left: 25px;
            position: relative;
            font-size: 0.9rem;
            color: #555;
        }
        
        .implementation-steps li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #8B0000;
            font-weight: bold;
        }
        
        .roi-calculator {
            background: linear-gradient(135deg, #f6f9fc, #ffffff);
            border: 1px dashed #8B0000;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .roi-calculator h5 {
            color: #8B0000;
            margin-bottom: 10px;
        }
        
        .roi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }
        
        .roi-item {
            text-align: center;
        }
        
        .roi-value {
            font-size: 1.4rem;
            font-weight: 700;
            color: #27ae60;
        }
        
        .roi-label {
            font-size: 0.8rem;
            color: #666;
        }
        
        .parameter-control {
            margin-bottom: 15px;
        }
        
        .parameter-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .parameter-name {
            color: #333;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .parameter-value-display {
            color: #8B0000;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .parameter-slider {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }
        
        .parameter-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: #8B0000;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .parameter-input {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 0.9rem;
            background: white;
            color: #333;
        }
        
        .parameter-input:focus {
            outline: none;
            border-color: #8B0000;
        }
        
        .update-btn {
            width: 100%;
            background: linear-gradient(135deg, #006400 0%, #008000 100%);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .update-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #008000 0%, #006400 100%);
            transform: translateY(-2px);
        }
        
        .update-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .main-content {
            padding: 25px;
            overflow-y: auto;
            background: white;
        }
        
        .content-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 25px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 5px;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 10px 20px;
            background: #f8f9fa;
            border: 1px solid transparent;
            border-radius: 8px 8px 0 0;
            color: #666;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        .tab:hover {
            background: #e9ecef;
            color: #8B0000;
        }
        
        .tab.active {
            background: #8B0000;
            color: white;
            border-color: #8B0000;
        }
        
        .tab-content {
            display: none;
            color: #333;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            border: 2px solid #e0e0e0;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .chart-title {
            color: #8B0000;
            font-size: 1.1rem;
            font-weight: 600;
            flex: 1;
        }
        
        .chart-description {
            background: #f8f9fa;
            border-left: 4px solid #8B0000;
            padding: 15px;
            margin-top: 15px;
            border-radius: 0 8px 8px 0;
            font-size: 0.9rem;
            line-height: 1.5;
            color: #555;
        }
        
        .metric-analysis {
            background: #f0f8ff;
            border: 1px solid #e0f0ff;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-size: 0.9rem;
        }
        
        .metric-analysis h4 {
            color: #8B0000;
            margin-bottom: 10px;
            font-size: 1rem;
        }
        
        canvas {
            max-height: 300px;
        }
        
        .indicators-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .indicator-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            text-align: center;
            transition: transform 0.3s;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .indicator-card:hover {
            transform: translateY(-3px);
            border-color: #8B0000;
        }
        
        .indicator-value {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 8px 0;
        }
        
        .indicator-label {
            color: #666;
            font-size: 0.85rem;
        }
        
        .indicator-change {
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 12px;
            margin-top: 6px;
            display: inline-block;
        }
        
        .positive {
            background: rgba(0, 128, 0, 0.1);
            color: #008000;
        }
        
        .negative {
            background: rgba(139, 0, 0, 0.1);
            color: #8B0000;
        }
        
        .charts-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        @media (max-width: 1200px) {
            .charts-row {
                grid-template-columns: 1fr;
            }
        }
        
        .three-contour-model {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        @media (max-width: 1200px) {
            .three-contour-model {
                grid-template-columns: 1fr;
            }
        }
        
        .contour-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid;
            position: relative;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .contour-1 {
            border-color: #8B0000;
        }
        
        .contour-2 {
            border-color: #A52A2A;
        }
        
        .contour-3 {
            border-color: #B22222;
        }
        
        .contour-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }
        
        .contour-icon {
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
            border: 2px solid;
        }
        
        .contour-1 .contour-icon {
            background: #8B0000;
            color: white;
            border-color: #8B0000;
        }
        
        .contour-2 .contour-icon {
            background: #A52A2A;
            color: white;
            border-color: #A52A2A;
        }
        
        .contour-3 .contour-icon {
            background: #B22222;
            color: white;
            border-color: #B22222;
        }
        
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 20px;
        }
        
        .loading.active {
            display: flex;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            color: #666;
            text-align: center;
            padding: 30px;
        }
        
        .empty-icon {
            font-size: 80px;
            color: #8B0000;
            opacity: 0.2;
            margin-bottom: 20px;
        }
        
        .hidden {
            display: none !important;
        }
        
        .mt-20 { margin-top: 20px; }
        .mt-30 { margin-top: 30px; }
        .text-success { color: #008000; }
        .text-danger { color: #8B0000; }
        .text-warning { color: #ff9800; }
        
        .info-box {
            background: #f0f7ff;
            border-left: 4px solid #2196F3;
            padding: 12px;
            margin: 10px 0;
            border-radius: 0 4px 4px 0;
            font-size: 0.85rem;
        }
        
        .metrics-note {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
        
        .separator {
            margin: 20px 0;
            border-top: 1px dashed #ccc;
        }
        
        .export-footer {
            grid-column: 1 / -1;
            background: #f8f9fa;
            padding: 20px 40px;
            border-top: 2px solid #8B0000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .export-footer-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .footer-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
        }
        
        .footer-btn.pdf {
            background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%);
        }
        
        .footer-btn.excel {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        }
        
        .footer-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .footer-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .footer-info {
            color: #333;
            font-size: 0.9rem;
        }
        
        .footer-info strong {
            color: #8B0000;
        }
        
        .ai-analysis-summary {
            background: linear-gradient(135deg, #8B0000 0%, #600000 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
        }
        
        .ai-analysis-summary h3 {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .ai-analysis-summary p {
            opacity: 0.95;
            line-height: 1.6;
        }
        
        .model-description {
            background: #f0f7f0;
            border-left: 4px solid #008000;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
            font-size: 0.9rem;
            line-height: 1.5;
            color: #555;
        }

        .act-badge {
            background: #d4edda;
            border-left: 6px solid #28a745;
            padding: 15px;
            border-radius: 8px;
            color: #155724;
            font-weight: 500;
            margin-bottom: 20px;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <div style="color: white; font-size: 1.1rem;">AI-–∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–∏...</div>
    </div>
    
    <div class="container">
        <header>
            <div class="header-content">
                <h1>–¢—Ä–µ—Ö–∫–æ–Ω—Ç—É—Ä–Ω–∞—è AI-—Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è–º–∏</h1>
                <p class="subtitle">–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞: —Å–∏–Ω–µ—Ä–≥–∏—è —á–µ–ª–æ–≤–µ–∫–∞ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</p>
            </div>
            <div class="header-bg">
                ü§ñ
            </div>
        </header>
        
        <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å - –ü–æ–∏—Å–∫ –∫–æ–º–ø–∞–Ω–∏–∏ -->
        <div class="left-panel">
            <div class="panel-section">
                <h2 class="section-title">üîç –û–±—ä–µ–∫—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è</h2>
                <div class="company-info">
                    <div class="company-header">
                        <div class="company-logo" id="companyLogo">–ú–ü</div>
                        <div>
                            <h3 style="color: #8B0000; margin-bottom: 5px;" id="companyName">–û–û–û ¬´–ú–æ–±–∞–π–ª –ü–∞—Ä–∫ –ò–¢¬ª</h3>
                            <p style="color: #666; font-size: 0.85rem;" id="companyDetails">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è, –æ–±—ä–µ–∫—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –º–∞–≥–∏—Å—Ç–µ—Ä—Å–∫–æ–π –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–∏</p>
                        </div>
                    </div>
                    
                    <div class="inn-input-container">
                        <input type="text" 
                               class="inn-input" 
                               id="innInput" 
                               placeholder="–ò–ù–ù –∫–æ–º–ø–∞–Ω–∏–∏ (5047154189)"
                               value="5047154189">
                        <button class="search-btn" onclick="searchByINN()">
                            üîç –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏
                        </button>
                    </div>
                    
                    <div class="export-buttons" id="exportButtons">
                        <button class="export-btn pdf" onclick="exportToPDF()" disabled id="exportPdfBtn">
                            üìÑ PDF –æ—Ç—á–µ—Ç
                        </button>
                        <button class="export-btn excel" onclick="exportToExcel()" disabled id="exportExcelBtn">
                            üìä Excel –æ—Ç—á–µ—Ç
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="panel-section">
                <h2 class="section-title">üìä –¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h2>
                <div class="indicators-grid" id="currentIndicators">
                    <!-- –ü—É—Å—Ç–æ –¥–æ –∞–Ω–∞–ª–∏–∑–∞ -->
                </div>
            </div>
        </div>
        
        <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å - –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content">
            <div class="content-tabs">
                <div class="tab active" onclick="switchTab('analysis')">üìà –ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</div>
                <div class="tab" onclick="switchTab('contours')">üèõÔ∏è –¢—Ä–µ—Ö–∫–æ–Ω—Ç—É—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</div>
                <div class="tab" onclick="switchTab('results')">üìä –ü—Ä–æ–≥–Ω–æ–∑ –∏ —ç—Ñ—Ñ–µ–∫—Ç</div>
                <div class="tab" onclick="switchTab('recommendations')">üéØ XAI –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</div>
                <div class="tab" onclick="switchTab('algorithms')">üßÆ –ê–ª–≥–æ—Ä–∏—Ç–º—ã –ò–ò</div>
            </div>
            
            <div class="tab-content active" id="analysisTab">
                <div class="empty-state" id="emptyAnalysisState">
                    <div class="empty-icon">üìä</div>
                    <h2 class="empty-title">–ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π</h2>
                    <p class="empty-description">
                        –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –û–û–û ¬´–ú–æ–±–∞–π–ª –ü–∞—Ä–∫ –ò–¢¬ª –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–µ—Ö–∫–æ–Ω—Ç—É—Ä–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π
                    </p>
                </div>
                
                <div id="analysisInfo" class="hidden">
                    <div class="ai-analysis-summary" id="aiSummary">
                        <!-- AI Summary –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    
                    <!-- –ê–ö–¢ –í–ù–ï–î–†–ï–ù–ò–Ø -->
                    <div class="act-badge">
                        <strong>‚úÖ –ê–∫—Ç –≤–≤–æ–¥–∞ –≤ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—É—é —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é –æ—Ç 01.12.2025</strong><br>
                        –°–∏—Å—Ç–µ–º–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∞ –≤ –û–û–û ¬´–ú–æ–±–∞–π–ª –ü–∞—Ä–∫ –ò–¢¬ª, R¬≤ = 0.89 (–º–æ–¥–µ–ª—å LTV), –ø—Ä–æ–µ–∫—Ç–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
                    </div>
                    
                    <h2 class="section-title" id="analysisTitle">–ê–Ω–∞–ª–∏–∑: –û–û–û ¬´–ú–æ–±–∞–π–ª –ü–∞—Ä–∫ –ò–¢¬ª</h2>
                    
                    <!-- –î–≤–∞ –≥—Ä–∞—Ñ–∏–∫–∞ –≤ —Ä—è–¥: KPI (–ø—Ä–æ—Ü–µ–Ω—Ç—ã) –∏ –í—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏–π (–¥–Ω–∏) -->
                    <div class="charts-row">
                        <div class="chart-container" id="chart1">
                            <div class="chart-header">
                                <h3 class="chart-title">üìà –ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (KPI), %</h3>
                            </div>
                            <div style="position: relative; height: 300px;">
                                <canvas id="currentMetricsChart"></canvas>
                            </div>
                            <div class="metrics-note">ROI, –æ—Ç—Ç–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤, —É—Å–ø–µ—à–Ω–æ—Å—Ç—å R&D ‚Äî –ø–æ –¥–∞–Ω–Ω—ã–º –∫–æ–º–ø–∞–Ω–∏–∏</div>
                        </div>
                        
                        <div class="chart-container" id="chart2">
                            <div class="chart-header">
                                <h3 class="chart-title">‚è±Ô∏è –í—Ä–µ–º—è –ø—Ä–∏–Ω—è—Ç–∏—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π</h3>
                            </div>
                            <div style="position: relative; height: 300px;">
                                <canvas id="decisionTimeChart"></canvas>
                            </div>
                            <div class="metrics-note">–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Å 4 –Ω–µ–¥–µ–ª—å –¥–æ 10 –¥–Ω–µ–π</div>
                        </div>
                    </div>
                    
                    <div class="chart-container" id="chart3">
                        <div class="chart-header">
                            <h3 class="chart-title">üéØ –ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–∂–∏–∑–Ω–µ–Ω–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ (LTV)</h3>
                        </div>
                        <div style="position: relative; height: 300px;">
                            <canvas id="ltvChart"></canvas>
                        </div>
                        <div class="model-description" id="ltvDescription">
                            <!-- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ LTV –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="contoursTab">
                <h2 class="section-title">üèõÔ∏è –¢—Ä–µ—Ö–∫–æ–Ω—Ç—É—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞</h2>
                <p style="margin-bottom: 15px; color: #555;">–°–∏–Ω–µ—Ä–≥–∏—è —á–µ–ª–æ–≤–µ–∫–∞ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∑–∞ —Å—á–µ—Ç –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π</p>
                
                <div class="three-contour-model">
                    <div class="contour-card contour-1">
                        <div class="contour-header">
                            <div class="contour-icon">üéØ</div>
                            <div>
                                <div class="contour-title">–ö–æ–Ω—Ç—É—Ä 1: –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–π</div>
                                <div class="contour-subtitle">–ß–µ–ª–æ–≤–µ–∫ + –ò–ò-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç</div>
                            </div>
                        </div>
                        <div class="contour-content">
                            <strong>–ß–µ–ª–æ–≤–µ–∫</strong> –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ —Ü–µ–ª–∏, <strong>–ò–ò</strong> –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å—Ü–µ–Ω–∞—Ä–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞.
                        </div>
                        <div class="info-box">
                            <strong>–§—É–Ω–∫—Ü–∏—è:</strong> –¶–µ–ª–µ–ø–æ–ª–∞–≥–∞–Ω–∏–µ –∏ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
                        </div>
                    </div>
                    
                    <div class="contour-card contour-2">
                        <div class="contour-header">
                            <div class="contour-icon">‚ö°</div>
                            <div>
                                <div class="contour-title">–ö–æ–Ω—Ç—É—Ä 2: –¢–∞–∫—Ç–∏—á–µ—Å–∫–∏–π</div>
                                <div class="contour-subtitle">–°–∏–º–±–∏–æ–∑ —á–µ–ª–æ–≤–µ–∫–∞ –∏ –ò–ò</div>
                            </div>
                        </div>
                        <div class="contour-content">
                            <strong>–ò–ò</strong> –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã. <strong>–ß–µ–ª–æ–≤–µ–∫</strong> –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.
                        </div>
                        <div class="info-box">
                            <strong>–§—É–Ω–∫—Ü–∏—è:</strong> –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π, –æ–±—ä—è—Å–Ω–∏–º—ã–π –ò–ò (XAI)
                        </div>
                    </div>
                    
                    <div class="contour-card contour-3">
                        <div class="contour-header">
                            <div class="contour-icon">ü§ñ</div>
                            <div>
                                <div class="contour-title">–ö–æ–Ω—Ç—É—Ä 3: –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π</div>
                                <div class="contour-subtitle">–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</div>
                            </div>
                        </div>
                        <div class="contour-content">
                            <strong>–ò–ò</strong> —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä—É—Ç–∏–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏: –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π, –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ.
                        </div>
                        <div class="info-box">
                            <strong>–§—É–Ω–∫—Ü–∏—è:</strong> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö, MLOps
                        </div>
                    </div>
                </div>
                
                <div class="chart-container" id="chart4">
                    <div class="chart-header">
                        <h3 class="chart-title">üîÑ Q-learning –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è R&D</h3>
                    </div>
                    <div style="position: relative; height: 300px;">
                        <canvas id="qlearningChart"></canvas>
                    </div>
                    <div class="model-description" id="qlearningDescription">
                        <!-- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ Q-learning –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="resultsTab">
                <h2 class="section-title">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∏ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç</h2>
                
                <div class="empty-state" id="emptyResultsState">
                    <div class="empty-icon">üìà</div>
                    <h2 class="empty-title">–ü—Ä–æ–≥–Ω–æ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h2>
                    <p class="empty-description">
                        –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞
                    </p>
                </div>
                
                <div id="resultsInfo" class="hidden">
                    <div class="charts-row">
                        <div class="chart-container" id="chart5">
                            <div class="chart-header">
                                <h3 class="chart-title">üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π: –¥–æ/–ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è</h3>
                            </div>
                            <div style="position: relative; height: 300px;">
                                <canvas id="comparisonPercentageChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-container" id="chart6">
                            <div class="chart-header">
                                <h3 class="chart-title">‚è±Ô∏è –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π</h3>
                            </div>
                            <div style="position: relative; height: 300px;">
                                <canvas id="comparisonTimeChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-analysis" id="comparisonAnalysis"></div>
                    
                    <div class="indicators-grid">
                        <div class="indicator-card">
                            <div class="indicator-value text-success" id="resultRoi">21%</div>
                            <div class="indicator-label">ROI –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è</div>
                            <div class="indicator-change positive" id="roiChange">+6%</div>
                        </div>
                        
                        <div class="indicator-card">
                            <div class="indicator-value text-success" id="resultChurn">7%</div>
                            <div class="indicator-label">–û—Ç—Ç–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</div>
                            <div class="indicator-change positive" id="churnChange">-3%</div>
                        </div>
                        
                        <div class="indicator-card">
                            <div class="indicator-value text-success" id="resultRdSuccess">65%</div>
                            <div class="indicator-label">–£—Å–ø–µ—à–Ω–æ—Å—Ç—å R&D</div>
                            <div class="indicator-change positive" id="rdChange">+25%</div>
                        </div>
                        
                        <div class="indicator-card">
                            <div class="indicator-value text-success" id="resultDecisionTime">10</div>
                            <div class="indicator-label">–î–Ω–µ–π –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ</div>
                            <div class="indicator-change positive" id="decisionChange">-18 –¥–Ω–µ–π</div>
                        </div>
                    </div>
                    
                    <div class="chart-container" id="chart7">
                        <div class="chart-header">
                            <h3 class="chart-title">üí∞ –ì–æ–¥–æ–≤–æ–π —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç: 26 –º–ª–Ω ‚ÇΩ</h3>
                        </div>
                        <div style="position: relative; height: 300px;">
                            <canvas id="economicChart"></canvas>
                        </div>
                        <div class="metric-analysis" id="economicAnalysis"></div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="recommendationsTab">
                <h2 class="section-title">üéØ –û–±—ä—è—Å–Ω–∏–º—ã–π –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç (XAI)</h2>
                <p style="margin-bottom: 15px; color: #555;">–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã ¬´—á–µ—Ä–Ω–æ–≥–æ —è—â–∏–∫–∞¬ª —Å –ø–æ–º–æ—â—å—é SHAP-–∞–Ω–∞–ª–∏–∑–∞</p>
                
                <div class="empty-state" id="emptyRecommendationsState">
                    <div class="empty-icon">üéØ</div>
                    <h2 class="empty-title">XAI-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
                    <p class="empty-description">
                        –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
                    </p>
                </div>
                
                <div id="recommendationsInfo" class="hidden">
                    <div id="aiRecommendationsContainer">
                        <!-- AI —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="algorithmsTab">
                <h2 class="section-title">üßÆ –ö–æ–º–ø–ª–µ–∫—Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</h2>
                
                <div class="empty-state" id="emptyAlgorithmsState">
                    <div class="empty-icon">ü§ñ</div>
                    <h2 class="empty-title">LightGBM, Q-learning, –ê–≤—Ç–æ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫</h2>
                    <p class="empty-description">
                        –ê–ª–≥–æ—Ä–∏—Ç–º—ã, –ø–µ—Ä–µ–≤–µ–¥—à–∏–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é –æ—Å–Ω–æ–≤—É
                    </p>
                </div>
                
                <div id="algorithmsInfo" class="hidden">
                    <div class="chart-container" id="chart8">
                        <div class="chart-header">
                            <h3 class="chart-title">üéØ LightGBM + SHAP: —Ñ–∞–∫—Ç–æ—Ä—ã LTV</h3>
                        </div>
                        <div style="position: relative; height: 300px;">
                            <canvas id="lightgbmDetailChart"></canvas>
                        </div>
                        <div class="metric-analysis" id="ltvAnalysis"></div>
                    </div>
                    
                    <div class="chart-container" id="chart9">
                        <div class="chart-header">
                            <h3 class="chart-title">ü§ñ –ù–µ–π—Ä–æ—Å–µ—Ç—å-–∞–≤—Ç–æ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫: –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</h3>
                        </div>
                        <div style="position: relative; height: 300px;">
                            <canvas id="autoencoderChart"></canvas>
                        </div>
                        <div class="model-description">
                            <strong>–í—ã—è–≤–ª–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π:</strong> —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–µ–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Å—Ç–æ–µ–≤ –Ω–∞ 18%
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –∑—Ä–µ–ª–æ—Å—Ç—å –ò–ò -->
        <div class="right-panel">
            <div class="panel-section">
                <h2 class="section-title">‚öôÔ∏è –ò–Ω–¥–µ–∫—Å –∑—Ä–µ–ª–æ—Å—Ç–∏ –ò–ò</h2>
                <p style="color: #666; font-size: 0.9rem; margin-bottom: 15px;">
                    –£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–æ–π –∫–æ–º–∞–Ω–¥—ã: <strong style="color: #28a745;">¬´–í—ã—Å–æ–∫–∏–π¬ª</strong> (—Ä–æ—Å—Ç —Å ¬´–ù–∞—á–∞–ª—å–Ω–æ–≥–æ¬ª –∑–∞ 1 –≥–æ–¥)
                </p>
                <div style="background: #e0e0e0; height: 10px; border-radius: 5px; margin-bottom: 20px;">
                    <div style="width: 85%; background: #28a745; height: 10px; border-radius: 5px;"></div>
                </div>
                
                <div id="parameterControls">
                    <!-- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ—Å–ª–µ –ø–æ–∏—Å–∫–∞ -->
                </div>
                
                <button class="update-btn" onclick="updateAnalysis()" id="updateBtn" disabled>
                    üîÑ –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —Å –Ω–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
                </button>
            </div>
            
            <div class="panel-section">
                <h2 class="section-title">üìã –ü—Ä–æ–≥–Ω–æ–∑–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h2>
                <div class="indicators-grid" id="forecastIndicators">
                    <!-- –ü—Ä–æ–≥–Ω–æ–∑–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <div class="panel-section">
                <h2 class="section-title">üéØ XAI: SHAP-–æ–±—ä—è—Å–Ω–µ–Ω–∏—è</h2>
                <div id="quickRecommendationsList" style="max-height: 400px; overflow-y: auto;">
                    <!-- –ë—ã—Å—Ç—Ä—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
        
        <!-- Footer —Å —ç–∫—Å–ø–æ—Ä—Ç–æ–º -->
        <div class="export-footer">
            <div class="footer-info">
                <span id="exportCompanyInfo">üîç –û—Ç—á–µ—Ç –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é: <strong>–û–û–û ¬´–ú–æ–±–∞–π–ª –ü–∞—Ä–∫ –ò–¢¬ª</strong> (–ê–∫—Ç –æ—Ç 01.12.2025)</span>
            </div>
            <div class="export-footer-buttons">
                <button class="footer-btn pdf" onclick="exportToPDF()" id="footerExportPdfBtn" disabled>
                    üìÑ –°–∫–∞—á–∞—Ç—å PDF –æ—Ç—á–µ—Ç
                </button>
                <button class="footer-btn excel" onclick="exportToExcel()" id="footerExportExcelBtn" disabled>
                    üìä –°–∫–∞—á–∞—Ç—å Excel –æ—Ç—á–µ—Ç
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π: –¢–û–õ–¨–ö–û –û–û–û ¬´–ú–æ–±–∞–π–ª –ü–∞—Ä–∫ –ò–¢¬ª –≤ —Å—Ç—Ä–æ–≥–æ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–µ–π
        const companyDatabase = {
            "5047154189": {
                name: "–û–û–û ¬´–ú–æ–±–∞–π–ª –ü–∞—Ä–∫ –ò–¢¬ª",
                inn: "5047154189",
                description: "–û–±—ä–µ–∫—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –º–∞–≥–∏—Å—Ç–µ—Ä—Å–∫–æ–π –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–∏. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Ç—Ä–µ—Ö–∫–æ–Ω—Ç—É—Ä–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ò–ò.",
                industry: "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, IoT, —Ç–µ–ª–µ–º–∞—Ç–∏–∫–∞",
                founded: 2015,
                employees: 250,
                marketPosition: "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ IoT-—Ä–µ—à–µ–Ω–∏–π",
                parameters: {
                    annualRevenue: { value: 2800, min: 0, max: 10000, step: 100, unit: "–º–ª–Ω ‚ÇΩ" },
                    rdBudget: { value: 784, min: 0, max: 5000, step: 50, unit: "–º–ª–Ω ‚ÇΩ" },
                    keyClients: { value: 45, min: 0, max: 300, step: 5, unit: "—à—Ç" },
                    rdProjects: { value: 15, min: 0, max: 100, step: 1, unit: "—à—Ç" },
                    employees: { value: 250, min: 0, max: 5000, step: 10, unit: "—á–µ–ª" },
                    customerLifetime: { value: 3.2, min: 0, max: 20, step: 0.1, unit: "–ª–µ—Ç" },
                    avgProjectBudget: { value: 32, min: 0, max: 500, step: 5, unit: "–º–ª–Ω ‚ÇΩ" },
                    infrastructureDowntime: { value: 48, min: 0, max: 720, step: 5, unit: "—á/–º–µ—Å" },
                    marketShare: { value: 3.5, min: 0, max: 50, step: 0.1, unit: "%" },
                    customerSatisfaction: { value: 82, min: 0, max: 100, step: 1, unit: "%" },
                    employeeTurnover: { value: 15, min: 0, max: 50, step: 1, unit: "%" },
                    innovationIndex: { value: 68, min: 0, max: 100, step: 1, unit: "–±–∞–ª–ª–æ–≤" }
                }
            }
        };
        
        let companyData = null;
        let calculatedResults = null;
        let charts = {};
        let aiRecommendations = [];
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('analysisInfo').classList.add('hidden');
            document.getElementById('resultsInfo').classList.add('hidden');
            document.getElementById('algorithmsInfo').classList.add('hidden');
            document.getElementById('recommendationsInfo').classList.add('hidden');
            
            document.getElementById('emptyAnalysisState').classList.remove('hidden');
            document.getElementById('emptyResultsState').classList.remove('hidden');
            document.getElementById('emptyAlgorithmsState').classList.remove('hidden');
            document.getElementById('emptyRecommendationsState').classList.remove('hidden');
            
            document.getElementById('updateBtn').disabled = true;
            document.getElementById('exportPdfBtn').disabled = true;
            document.getElementById('exportExcelBtn').disabled = true;
            document.getElementById('footerExportPdfBtn').disabled = true;
            document.getElementById('footerExportExcelBtn').disabled = true;
            
            document.getElementById('currentIndicators').innerHTML = '';
            document.getElementById('forecastIndicators').innerHTML = '';
            document.getElementById('quickRecommendationsList').innerHTML = '';
            document.getElementById('parameterControls').innerHTML = '';
            
            document.getElementById('innInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') searchByINN();
            });
        });
        
        function searchByINN() {
            const inn = document.getElementById('innInput').value.trim();
            
            if (!inn) {
                alert('–í–≤–µ–¥–∏—Ç–µ –ò–ù–ù –∫–æ–º–ø–∞–Ω–∏–∏');
                return;
            }
            
            showLoading(true);
            
            setTimeout(() => {
                if (companyDatabase[inn]) {
                    companyData = JSON.parse(JSON.stringify(companyDatabase[inn]));
                } else {
                    // –ï—Å–ª–∏ –≤–≤–µ–¥–µ–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π –ò–ù–ù, –≤—Å–µ —Ä–∞–≤–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–∏
                    companyData = JSON.parse(JSON.stringify(companyDatabase["5047154189"]));
                    companyData.name = "–û–û–û ¬´–ú–æ–±–∞–π–ª –ü–∞—Ä–∫ –ò–¢¬ª (—ç—Ç–∞–ª–æ–Ω)";
                    companyData.inn = inn;
                }
                
                initializeAnalysis();
                showLoading(false);
            }, 1000);
        }
        
        function initializeAnalysis() {
            document.getElementById('updateBtn').disabled = false;
            document.getElementById('exportPdfBtn').disabled = false;
            document.getElementById('exportExcelBtn').disabled = false;
            document.getElementById('footerExportPdfBtn').disabled = false;
            document.getElementById('footerExportExcelBtn').disabled = false;
            
            document.getElementById('companyName').textContent = companyData.name;
            document.getElementById('companyDetails').textContent = companyData.description;
            document.getElementById('companyLogo').textContent = companyData.name.charAt(0);
            
            document.getElementById('exportCompanyInfo').innerHTML = `üìå –û–±—ä–µ–∫—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è: <strong>${companyData.name}</strong> | –ê–∫—Ç –æ—Ç 01.12.2025 | R¬≤ = 0.89`;
            
            createParameterControls();
            calculateMetrics();
            generateAIRecommendations();
            updateDisplay();
            createCharts();
            updateAnalysisTexts();
            displayAIRecommendations();
            updateModelDescriptions();
            
            document.getElementById('emptyAnalysisState').classList.add('hidden');
            document.getElementById('analysisInfo').classList.remove('hidden');
            
            document.getElementById('emptyResultsState').classList.add('hidden');
            document.getElementById('resultsInfo').classList.remove('hidden');
            
            document.getElementById('emptyAlgorithmsState').classList.add('hidden');
            document.getElementById('algorithmsInfo').classList.remove('hidden');
            
            document.getElementById('emptyRecommendationsState').classList.add('hidden');
            document.getElementById('recommendationsInfo').classList.remove('hidden');
            
            switchTab('analysis');
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è LTV –∏ Q-learning (–≤ —Å—Ç—Ä–æ–≥–æ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –í–ö–†)
        function updateModelDescriptions() {
            // –û–ø–∏—Å–∞–Ω–∏–µ LTV
            const ltvDesc = document.getElementById('ltvDescription');
            if (ltvDesc && companyData && calculatedResults) {
                const current = calculatedResults.current;
                const improved = calculatedResults.improved;
                
                ltvDesc.innerHTML = `
                    <h4 style="color: #008000; margin-bottom: 10px;">üéØ LightGBM —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (Optuna)</h4>
                    <p><strong>–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ (R¬≤):</strong> 0.89 (–ø—Ä–æ–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ)</p>
                    <p><strong>–¢–µ–∫—É—â–∏–π LTV:</strong> ${current.avgLtv} –º–ª–Ω ‚ÇΩ</p>
                    <p><strong>–ü—Ä–æ–≥–Ω–æ–∑ LTV:</strong> ${improved.avgLtv} –º–ª–Ω ‚ÇΩ</p>
                    <p><strong>–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã ¬´—á–µ—Ä–Ω–æ–≥–æ —è—â–∏–∫–∞¬ª:</strong> SHAP-–¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∞.</p>
                `;
            }
            
            // –û–ø–∏—Å–∞–Ω–∏–µ Q-learning
            const qlearningDesc = document.getElementById('qlearningDescription');
            if (qlearningDesc && companyData) {
                qlearningDesc.innerHTML = `
                    <h4 style="color: #ff9800; margin-bottom: 10px;">üîÑ –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Q-learning –¥–ª—è R&D –ø–æ—Ä—Ç—Ñ–µ–ª—è</h4>
                    <p><strong>–ö–æ–º–ø–æ–∑–∏—Ç–Ω–æ–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ:</strong> 70% ‚Äî —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ—Ç–¥–∞—á–∞, 20% ‚Äî –ø–∞—Ç–µ–Ω—Ç–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª, 10% ‚Äî —Ä–æ—Å—Ç –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π.</p>
                    <p><strong>–°—Ç—Ä–∞—Ç–µ–≥–∏—è Œµ-–∂–∞–¥–Ω–æ—Å—Ç–∏:</strong> –æ—Ç 100% –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∫ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏.</p>
                    <p><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –î–æ–ª—è –æ–∫—É–ø–∞—é—â–∏—Ö—Å—è R&D –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤—ã—Ä–æ—Å–ª–∞ —Å <strong>40% –¥–æ 65%</strong>.</p>
                `;
            }
        }
        
        function generateAIRecommendations() {
            if (!companyData || !calculatedResults) return;
            
            aiRecommendations = [];
            const params = companyData.parameters;
            const current = calculatedResults.current;
            const improved = calculatedResults.improved;
            const eco = calculatedResults.economic;
            
            // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å—Ç—Ä–æ–≥–æ –ø–æ —Ç–µ–∫—Å—Ç—É –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–∏
            aiRecommendations.push({
                id: 1,
                title: "üéØ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–±—ä—è—Å–Ω–∏–º–æ–≥–æ –ò–ò (XAI) —á–µ—Ä–µ–∑ SHAP",
                priority: "high",
                priorityText: "–†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É '–ß–µ—Ä–Ω–æ–≥–æ —è—â–∏–∫–∞'",
                category: "–î–æ–≤–µ—Ä–∏–µ –∫ –ò–ò",
                impact: `R¬≤ = 0.89`,
                roi: `${((improved.roi - current.roi) * 1.2).toFixed(1)}%`,
                investment: `14 –º–ª–Ω ‚ÇΩ`,
                payback: "6.5 –º–µ—Å—è—Ü–µ–≤",
                description: `–í–Ω–µ–¥—Ä–µ–Ω–∏–µ SHAP-–∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∞ LTV. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–Ω—è—Ç–Ω—ã—Ö –¥–∏–∞–≥—Ä–∞–º–º –¥–ª—è –±–∏–∑–Ω–µ—Å-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.`,
                steps: [
                    "–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å SHAP-–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –≤ –∫–æ–Ω—Ç—É—Ä–µ –º–æ–¥–µ–ª–∏ LightGBM",
                    "–°–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –≤–∫–ª–∞–¥–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤",
                    "–ü—Ä–æ–≤–µ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–µ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏",
                    "–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å XAI-–æ—Ç—á–µ—Ç—ã –≤ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π",
                    "–§–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ä–æ—Å—Ç –∏–Ω–¥–µ–∫—Å–∞ –∑—Ä–µ–ª–æ—Å—Ç–∏ –ò–ò"
                ],
                metrics: {
                    expectedGrowth: `+${(improved.roi - current.roi).toFixed(1)}% ROI`,
                    riskReduction: "–í—ã—Å–æ–∫–∞—è",
                    efficiencyGain: "–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å 100%"
                }
            });
            
            aiRecommendations.push({
                id: 2,
                title: "ü§ñ MLOps: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω–≤–µ–π–µ—Ä –ø—Ä–æ—Ç–∏–≤ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö",
                priority: "high",
                priorityText: "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π",
                category: "–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è",
                impact: `–°–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–µ–≤`,
                roi: `24%`,
                investment: `${(params.rdBudget.value * 0.018).toFixed(0)} –º–ª–Ω ‚ÇΩ`,
                payback: "5 –º–µ—Å—è—Ü–µ–≤",
                description: `–í–Ω–µ–¥—Ä–µ–Ω–∏–µ Apache Airflow + Evidently AI –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π.`,
                steps: [
                    "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö",
                    "–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä—ã –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π",
                    "–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å MLflow –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π",
                    "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π"
                ],
                metrics: {
                    downtimeReduction: "95%",
                    reliabilityIncrease: "99.9%",
                    costSavings: `${(eco.downtimeReduction)} –º–ª–Ω ‚ÇΩ`
                }
            });
            
            aiRecommendations.push({
                id: 3,
                title: "‚ö° –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ FastAPI",
                priority: "medium",
                priorityText: "–í—ã—Å–æ–∫–∏–π",
                category: "–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è",
                impact: `–ó–∞–¥–µ—Ä–∂–∫–∞ < 200 –º—Å`,
                roi: `18%`,
                investment: `${(params.annualRevenue.value * 0.015).toFixed(0)} –º–ª–Ω ‚ÇΩ`,
                payback: "7 –º–µ—Å—è—Ü–µ–≤",
                description: `–ö–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å —É–ø–∞–∫–æ–≤–∞–Ω–∞ –≤ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —Å REST API. –õ–µ–≥–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã.`,
                steps: [
                    "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π –≤ Docker",
                    "–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Kubernetes",
                    "–†–µ–∞–ª–∏–∑–∞—Ü–∏—è API Gateway",
                    "–°—Ç—Ä–æ–≥–∏–µ SLA: –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å 99.9%"
                ],
                metrics: {
                    timeReduction: "70%",
                    errorReduction: "90%",
                    productivityGain: "+45%"
                }
            });
            
            // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ –∏–Ω–¥–µ–∫—Å—É –∑—Ä–µ–ª–æ—Å—Ç–∏
            aiRecommendations.push({
                id: 4,
                title: "üìà –ü–æ–≤—ã—à–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ –∑—Ä–µ–ª–æ—Å—Ç–∏ –ò–ò —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–æ–π –∫–æ–º–∞–Ω–¥—ã",
                priority: "medium",
                priorityText: "–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–π",
                category: "–ö—É–ª—å—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö",
                impact: `–ù–∞—á–∞–ª—å–Ω—ã–π ‚Üí –í—ã—Å–æ–∫–∏–π`,
                roi: `32%`,
                investment: `4 –º–ª–Ω ‚ÇΩ`,
                payback: "9 –º–µ—Å—è—Ü–µ–≤",
                description: `–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—É–ª—å—Ç—É—Ä—ã, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ –¥–∞–Ω–Ω—ã—Ö. –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç SHAP-–æ–±—ä—è—Å–Ω–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–æ–≤.`,
                steps: [
                    "–ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏–Ω–≥–æ–≤ –ø–æ Data-Driven –∫—É–ª—å—Ç—É—Ä–µ",
                    "–í–Ω–µ–¥—Ä–µ–Ω–∏–µ KPI –¥–ª—è —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ò–ò",
                    "–°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π –ø–æ –ò–ò",
                    "–¢–∏—Ä–∞–∂–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ —Ö–æ–ª–¥–∏–Ω–≥–∞"
                ],
                metrics: {
                    npsGrowth: "+15 –ø—É–Ω–∫—Ç–æ–≤",
                    engagementScore: "+28%",
                    turnoverReduction: "-12%"
                }
            });
        }
        
        function displayAIRecommendations() {
            const container = document.getElementById('aiRecommendationsContainer');
            const quickContainer = document.getElementById('quickRecommendationsList');
            
            if (!container || !quickContainer) return;
            
            container.innerHTML = '';
            quickContainer.innerHTML = '';
            
            const sortedRecs = [...aiRecommendations].sort((a, b) => {
                const priorityOrder = { high: 1, medium: 2, low: 3 };
                return priorityOrder[a.priority] - priorityOrder[b.priority];
            });
            
            sortedRecs.forEach(rec => {
                const recElement = document.createElement('div');
                recElement.className = `recommendation-card ${rec.priority}`;
                recElement.innerHTML = `
                    <div class="recommendation-header">
                        <div class="recommendation-title">
                            ${rec.title}
                            <span class="ai-recommendation-badge">XAI</span>
                        </div>
                        <span class="recommendation-priority priority-${rec.priority}">${rec.priorityText}</span>
                    </div>
                    <div class="recommendation-metrics">
                        <span class="metric-tag">
                            <span>üìä –≠—Ñ—Ñ–µ–∫—Ç</span>
                            <strong>${rec.impact}</strong>
                        </span>
                        <span class="metric-tag">
                            <span>üí∞ ROI</span>
                            <strong>${rec.roi}</strong>
                        </span>
                        <span class="metric-tag">
                            <span>üíµ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</span>
                            <strong>${rec.investment}</strong>
                        </span>
                        <span class="metric-tag">
                            <span>‚è±Ô∏è –û–∫—É–ø–∞–µ–º–æ—Å—Ç—å</span>
                            <strong>${rec.payback}</strong>
                        </span>
                    </div>
                    <div class="recommendation-description">
                        ${rec.description}
                    </div>
                    <div class="implementation-steps">
                        <h5>üìã –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:</h5>
                        <ul>
                            ${rec.steps.map(step => `<li>${step}</li>`).join('')}
                        </ul>
                    </div>
                `;
                container.appendChild(recElement);
                
                // –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è (XAI –∑–∞–º–µ—Ç–∫–∞)
                const quickElement = document.createElement('div');
                quickElement.style.cssText = `
                    background: white;
                    border-radius: 8px;
                    padding: 15px;
                    margin-bottom: 12px;
                    border-left: 4px solid ${rec.priority === 'high' ? '#c0392b' : rec.priority === 'medium' ? '#e67e22' : '#f39c12'};
                    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
                `;
                quickElement.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                        <strong style="color: #2c3e50; font-size: 0.9rem;">${rec.title}</strong>
                    </div>
                    <div style="font-size: 0.8rem; color: #666;">
                        ${rec.description.substring(0, 80)}...
                    </div>
                `;
                quickContainer.appendChild(quickElement);
            });
            
            // AI Summary —Å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º –ê–∫—Ç–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è
            const aiSummary = document.getElementById('aiSummary');
            if (aiSummary) {
                aiSummary.innerHTML = `
                    <h3>ü§ñ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤ –û–û–û ¬´–ú–æ–±–∞–π–ª –ü–∞—Ä–∫ –ò–¢¬ª</h3>
                    <p style="font-size: 1.1rem; margin-bottom: 10px;">
                        <strong>–ê–∫—Ç –≤–≤–æ–¥–∞ –≤ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—É—é —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é –æ—Ç 01.12.2025</strong>
                    </p>
                    <p>–°–æ–≤–æ–∫—É–ø–Ω—ã–π –≥–æ–¥–æ–≤–æ–π —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç: <strong>–¥–≤–∞–¥—Ü–∞—Ç—å —à–µ—Å—Ç—å –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Ä—É–±–ª–µ–π</strong>.<br>
                    –ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ: <strong>—á–µ—Ç—ã—Ä–Ω–∞–¥—Ü–∞—Ç—å –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Ä—É–±–ª–µ–π</strong>.<br>
                    –°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏: <strong>–º–µ–Ω–µ–µ —Å–µ–º–∏ –º–µ—Å—è—Ü–µ–≤</strong> (—à–µ—Å—Ç—å —Å –ø–æ–ª–æ–≤–∏–Ω–æ–π).</p>
                    <p>–î–æ–ª—è –æ–∫—É–ø–∞—é—â–∏—Ö—Å—è R&D –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤—ã—Ä–æ—Å–ª–∞ —Å <strong>40% –¥–æ 65%</strong>.<br>
                    ROI –ø–æ—Ä—Ç—Ñ–µ–ª—è: —Å <strong>15% –¥–æ 21%</strong>. –û—Ç—Ç–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤: —Å <strong>10% –¥–æ 7%</strong>.<br>
                    –í—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏–π: —Å <strong>4 –Ω–µ–¥–µ–ª—å –¥–æ 10 –¥–Ω–µ–π</strong>.</p>
                `;
            }
        }
        
        function getMetricLabel(key) {
            const labels = {
                expectedGrowth: "–†–æ—Å—Ç ROI",
                riskReduction: "–°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∏—Å–∫–æ–≤",
                efficiencyGain: "–†–æ—Å—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",
                churnReduction: "–°–Ω–∏–∂–µ–Ω–∏–µ –æ—Ç—Ç–æ–∫–∞",
                retentionIncrease: "–†–æ—Å—Ç —É–¥–µ—Ä–∂–∞–Ω–∏—è",
                npsGrowth: "–†–æ—Å—Ç NPS",
                successRate: "–£—Å–ø–µ—à–Ω–æ—Å—Ç—å",
                timeToMarket: "Time to Market",
                costReduction: "–°–Ω–∏–∂–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç",
                timeReduction: "–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏",
                productivityGain: "–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",
                errorReduction: "–û—à–∏–±–∫–∏",
                downtimeReduction: "–ü—Ä–æ—Å—Ç–æ–∏",
                costSavings: "–≠–∫–æ–Ω–æ–º–∏—è",
                reliabilityIncrease: "–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å",
                ltvGrowth: "–†–æ—Å—Ç LTV",
                crossSellRate: "–ö—Ä–æ—Å—Å-–ø—Ä–æ–¥–∞–∂–∏",
                marketingROI: "ROI –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞",
                turnoverReduction: "–¢–µ–∫—É—á–µ—Å—Ç—å",
                engagementScore: "–í–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å",
                hiringCosts: "–ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –Ω–∞–π–º",
                searchTime: "–ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏",
                reuseRate: "–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ",
                onboardingTime: "–ê–¥–∞–ø—Ç–∞—Ü–∏—è"
            };
            return labels[key] || key;
        }
        
        function createParameterControls() {
            const container = document.getElementById('parameterControls');
            container.innerHTML = '';
            
            Object.entries(companyData.parameters).forEach(([key, param]) => {
                const control = document.createElement('div');
                control.className = 'parameter-control';
                control.innerHTML = `
                    <div class="parameter-label">
                        <span class="parameter-name">${getParameterName(key)}</span>
                        <span class="parameter-value-display" id="${key}Value">${param.value} ${param.unit}</span>
                    </div>
                    <input type="range" 
                           class="parameter-slider" 
                           id="${key}Slider"
                           min="${param.min}" 
                           max="${param.max}" 
                           step="${param.step}" 
                           value="${param.value}"
                           oninput="updateParameter('${key}', this.value)">
                    <input type="number" 
                           class="parameter-input mt-20" 
                           id="${key}Input"
                           value="${param.value}"
                           min="${param.min}"
                           max="${param.max}"
                           step="${param.step}"
                           onchange="updateParameter('${key}', this.value)">
                `;
                container.appendChild(control);
            });
        }
        
        function getParameterName(key) {
            const names = {
                annualRevenue: "–ì–æ–¥–æ–≤–∞—è –≤—ã—Ä—É—á–∫–∞",
                rdBudget: "–ë—é–¥–∂–µ—Ç R&D",
                keyClients: "–ö–ª—é—á–µ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã",
                rdProjects: "R&D –ø—Ä–æ–µ–∫—Ç—ã",
                employees: "–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏",
                customerLifetime: "–°—Ä–æ–∫ –∂–∏–∑–Ω–∏ –∫–ª–∏–µ–Ω—Ç–∞",
                avgProjectBudget: "–°—Ä–µ–¥–Ω–∏–π –±—é–¥–∂–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞",
                infrastructureDowntime: "–ü—Ä–æ—Å—Ç–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã",
                marketShare: "–î–æ–ª—è —Ä—ã–Ω–∫–∞",
                customerSatisfaction: "–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤",
                employeeTurnover: "–¢–µ–∫—É—á–µ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞",
                innovationIndex: "–ò–Ω–¥–µ–∫—Å –∏–Ω–Ω–æ–≤–∞—Ü–∏–π"
            };
            return names[key] || key;
        }
        
        function updateParameter(key, value) {
            const numValue = parseFloat(value);
            companyData.parameters[key].value = numValue;
            
            document.getElementById(`${key}Value`).textContent = `${numValue} ${companyData.parameters[key].unit}`;
            document.getElementById(`${key}Slider`).value = numValue;
            document.getElementById(`${key}Input`).value = numValue;
        }
        
        function updateAnalysis() {
            showLoading(true);
            setTimeout(() => {
                calculateMetrics();
                generateAIRecommendations();
                updateDisplay();
                updateCharts();
                updateAnalysisTexts();
                displayAIRecommendations();
                updateModelDescriptions();
                showLoading(false);
            }, 500);
        }
        
        function calculateMetrics() {
            if (!companyData) return;
            
            const params = companyData.parameters;
            
            // –ë–∞–∑–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –î–û –≤–Ω–µ–¥—Ä–µ–Ω–∏—è (—Å—Ç—Ä–æ–≥–æ –ø–æ –í–ö–†)
            const baseRoi = 15.0;          // 15%
            const baseChurn = 10.0;         // 10%
            const baseRdSuccess = 40.0;     // 40%
            const baseDecisionTime = 28.0;  // 4 –Ω–µ–¥–µ–ª–∏ = 28 –¥–Ω–µ–π
            
            // –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ü–û–°–õ–ï –≤–Ω–µ–¥—Ä–µ–Ω–∏—è (—Å—Ç—Ä–æ–≥–æ –ø–æ –í–ö–†)
            const improvedRoi = 21.0;           // 21%
            const improvedChurn = 7.0;          // 7%
            const improvedRdSuccess = 65.0;     // 65%
            const improvedDecisionTime = 10.0;  // 10 –¥–Ω–µ–π
            
            // –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç (—Å—Ç—Ä–æ–≥–æ –ø–æ –í–ö–†)
            const totalEffect = 26.0;        // 26 –º–ª–Ω ‚ÇΩ
            const implementationCost = 14.0; // 14 –º–ª–Ω ‚ÇΩ
            const paybackMonths = 6.5;       // 6.5 –º–µ—Å—è—Ü–µ–≤
            
            // LTV (—Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–∏)
            const avgLtv = calculateLTV(params);
            const forecastLtv = avgLtv * 1.27; // –†–æ—Å—Ç LTV –Ω–∞ 27% (–∏–∑ –¥–æ–∫–ª–∞–¥–∞)
            
            calculatedResults = {
                current: {
                    roi: baseRoi.toFixed(1),
                    churn: baseChurn.toFixed(1),
                    rdSuccess: baseRdSuccess.toFixed(1),
                    decisionTime: baseDecisionTime.toFixed(0),
                    avgLtv: avgLtv.toFixed(1)
                },
                improved: {
                    roi: improvedRoi.toFixed(1),
                    churn: improvedChurn.toFixed(1),
                    rdSuccess: improvedRdSuccess.toFixed(1),
                    decisionTime: improvedDecisionTime.toFixed(0),
                    avgLtv: forecastLtv.toFixed(1)
                },
                economic: {
                    revenueIncrease: (totalEffect * 0.45).toFixed(1),
                    costReduction: (totalEffect * 0.25).toFixed(1),
                    downtimeReduction: (totalEffect * 0.18).toFixed(1),
                    hrSavings: (totalEffect * 0.12).toFixed(1),
                    totalEffect: totalEffect.toFixed(1),
                    implementationCost: implementationCost.toFixed(1),
                    paybackMonths: paybackMonths.toFixed(1)
                },
                ltvData: {
                    current: avgLtv,
                    forecast: forecastLtv,
                    improvement: ((forecastLtv - avgLtv) / avgLtv * 100).toFixed(1)
                },
                parameters: params
            };
        }
        
        function calculateLTV(params) {
            const revenue = params.annualRevenue.value;
            const clients = Math.max(params.keyClients.value, 1);
            const lifetime = params.customerLifetime.value;
            const satisfaction = params.customerSatisfaction ? params.customerSatisfaction.value / 100 : 0.8;
            
            return (revenue * 0.4 * lifetime * satisfaction) / (clients * 10);
        }
        
        function updateAnalysisTexts() {
            if (!calculatedResults) return;
            
            const current = calculatedResults.current;
            const improved = calculatedResults.improved;
            const economic = calculatedResults.economic;
            const ltv = calculatedResults.ltvData;
            
            const comparisonAnalysis = document.getElementById('comparisonAnalysis');
            comparisonAnalysis.innerHTML = `
                <h4>üìä –î–∏–Ω–∞–º–∏–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π</h4>
                <p><strong>ROI –ø–æ—Ä—Ç—Ñ–µ–ª—è:</strong> ${current.roi}% ‚Üí ${improved.roi}% (+${(improved.roi - current.roi).toFixed(1)}%)</p>
                <p><strong>–û—Ç—Ç–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤:</strong> ${current.churn}% ‚Üí ${improved.churn}% (-${(current.churn - improved.churn).toFixed(1)}%)</p>
                <p><strong>–î–æ–ª—è –æ–∫—É–ø–∞—é—â–∏—Ö—Å—è R&D –ø—Ä–æ–µ–∫—Ç–æ–≤:</strong> ${current.rdSuccess}% ‚Üí ${improved.rdSuccess}% (+${(improved.rdSuccess - current.rdSuccess).toFixed(1)}%)</p>
                <p><strong>–í—Ä–µ–º—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π:</strong> ${current.decisionTime} –¥–Ω–µ–π ‚Üí ${improved.decisionTime} –¥–Ω–µ–π (-${(current.decisionTime - improved.decisionTime)} –¥–Ω–µ–π)</p>
                <p><strong>–°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ R&D:</strong> 24 –º–µ—Å—è—Ü–∞ ‚Üí 19 –º–µ—Å—è—Ü–µ–≤</p>
            `;
            
            const economicAnalysis = document.getElementById('economicAnalysis');
            economicAnalysis.innerHTML = `
                <h4>üí∞ –°–æ–≤–æ–∫—É–ø–Ω—ã–π –≥–æ–¥–æ–≤–æ–π —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç</h4>
                <p><strong>–û–±—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç:</strong> –¥–≤–∞–¥—Ü–∞—Ç—å —à–µ—Å—Ç—å –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Ä—É–±–ª–µ–π (${parseFloat(economic.totalEffect).toLocaleString('ru-RU')} –º–ª–Ω ‚ÇΩ)</p>
                <p><strong>–ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:</strong> —á–µ—Ç—ã—Ä–Ω–∞–¥—Ü–∞—Ç—å –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Ä—É–±–ª–µ–π</p>
                <p><strong>–°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏:</strong> –º–µ–Ω–µ–µ —Å–µ–º–∏ –º–µ—Å—è—Ü–µ–≤ (${economic.paybackMonths} –º–µ—Å.)</p>
                <p><strong>–°—Ç–∞—Ç—É—Å:</strong> –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–∞—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —Å 01.12.2025, —Ä–µ—à–µ–Ω–∏–µ —Ç–∏—Ä–∞–∂–∏—Ä—É–µ—Ç—Å—è</p>
            `;
            
            const ltvAnalysis = document.getElementById('ltvAnalysis');
            if (ltvAnalysis) {
                ltvAnalysis.innerHTML = `
                    <h4>üéØ LightGBM + Optuna + SHAP</h4>
                    <p><strong>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ R¬≤:</strong> 0.89</p>
                    <p><strong>–¢–µ–∫—É—â–∏–π —Å—Ä–µ–¥–Ω–∏–π LTV:</strong> ${current.avgLtv} –º–ª–Ω ‚ÇΩ</p>
                    <p><strong>–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:</strong> ${improved.avgLtv} –º–ª–Ω ‚ÇΩ</p>
                    <p><strong>–ü—Ä–æ–±–ª–µ–º–∞ ¬´—á–µ—Ä–Ω–æ–≥–æ —è—â–∏–∫–∞¬ª —Ä–µ—à–µ–Ω–∞:</strong> SHAP-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞</p>
                `;
            }
        }
        
        function updateDisplay() {
            if (!calculatedResults) return;
            
            const current = calculatedResults.current;
            const improved = calculatedResults.improved;
            
            const currentIndicators = document.getElementById('currentIndicators');
            currentIndicators.innerHTML = `
                <div class="indicator-card">
                    <div class="indicator-value text-danger">${current.roi}%</div>
                    <div class="indicator-label">ROI –ø–æ—Ä—Ç—Ñ–µ–ª—è</div>
                    <div class="indicator-change negative">–ë—ã–ª–æ –¥–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-value text-danger">${current.churn}%</div>
                    <div class="indicator-label">–û—Ç—Ç–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</div>
                    <div class="indicator-change negative">–ò—Å—Ö–æ–¥–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-value text-danger">${current.rdSuccess}%</div>
                    <div class="indicator-label">–£—Å–ø–µ—à–Ω–æ—Å—Ç—å R&D</div>
                    <div class="indicator-change negative">–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-value text-danger">${current.decisionTime} –¥–Ω–µ–π</div>
                    <div class="indicator-label">–í—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏–π</div>
                    <div class="indicator-change negative">4 –Ω–µ–¥–µ–ª–∏</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-value text-danger">${current.avgLtv} –º–ª–Ω ‚ÇΩ</div>
                    <div class="indicator-label">–°—Ä–µ–¥–Ω–∏–π LTV</div>
                    <div class="indicator-change negative">–¢–µ–∫—É—â–∏–π</div>
                </div>
            `;
            
            const forecastIndicators = document.getElementById('forecastIndicators');
            forecastIndicators.innerHTML = `
                <div class="indicator-card">
                    <div class="indicator-value text-success">${improved.roi}%</div>
                    <div class="indicator-label">ROI –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è</div>
                    <div class="indicator-change positive">+${(improved.roi - current.roi).toFixed(1)}%</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-value text-success">${improved.churn}%</div>
                    <div class="indicator-label">–û—Ç—Ç–æ–∫ –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è</div>
                    <div class="indicator-change positive">-${(current.churn - improved.churn).toFixed(1)}%</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-value text-success">${improved.rdSuccess}%</div>
                    <div class="indicator-label">–£—Å–ø–µ—à–Ω–æ—Å—Ç—å R&D</div>
                    <div class="indicator-change positive">+${(improved.rdSuccess - current.rdSuccess).toFixed(1)}%</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-value text-success">${improved.decisionTime} –¥–Ω–µ–π</div>
                    <div class="indicator-label">–í—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏–π</div>
                    <div class="indicator-change positive">-${(current.decisionTime - improved.decisionTime)} –¥–Ω–µ–π</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-value text-success">${improved.avgLtv} –º–ª–Ω ‚ÇΩ</div>
                    <div class="indicator-label">–ü—Ä–æ–≥–Ω–æ–∑ LTV</div>
                    <div class="indicator-change positive">+${calculatedResults.ltvData.improvement}%</div>
                </div>
            `;
            
            document.getElementById('resultRoi').textContent = `${improved.roi}%`;
            document.getElementById('resultChurn').textContent = `${improved.churn}%`;
            document.getElementById('resultRdSuccess').textContent = `${improved.rdSuccess}%`;
            document.getElementById('resultDecisionTime').textContent = `${improved.decisionTime}`;
            
            const roiChange = (parseFloat(improved.roi) - parseFloat(current.roi)).toFixed(1);
            const churnChange = (parseFloat(current.churn) - parseFloat(improved.churn)).toFixed(1);
            const rdChange = (parseFloat(improved.rdSuccess) - parseFloat(current.rdSuccess)).toFixed(1);
            const decisionChange = (parseFloat(current.decisionTime) - parseFloat(improved.decisionTime)).toFixed(0);
            
            document.getElementById('roiChange').textContent = `+${roiChange}%`;
            document.getElementById('churnChange').textContent = `-${churnChange}%`;
            document.getElementById('rdChange').textContent = `+${rdChange}%`;
            document.getElementById('decisionChange').textContent = `-${decisionChange} –¥–Ω–µ–π`;
            
            document.getElementById('analysisTitle').textContent = `–ê–Ω–∞–ª–∏–∑: ${companyData.name}`;
        }
        
        function createCharts() {
            if (!companyData || !calculatedResults) return;
            
            createCurrentMetricsChart();
            createDecisionTimeChart();
            createLTVChart();
            createQlearningChart();
            createComparisonPercentageChart();
            createComparisonTimeChart();
            createEconomicChart();
            createLightGBMDetailChart();
            createAutoencoderChart();
        }
        
        function updateCharts() {
            Object.values(charts).forEach(chart => {
                if (chart && typeof chart.destroy === 'function') {
                    chart.destroy();
                }
            });
            charts = {};
            createCharts();
        }
        
        function createCurrentMetricsChart() {
            const ctx = document.getElementById('currentMetricsChart').getContext('2d');
            const current = calculatedResults.current;
            
            charts.currentMetricsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['ROI –ø–æ—Ä—Ç—Ñ–µ–ª—è', '–û—Ç—Ç–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤', '–£—Å–ø–µ—à–Ω–æ—Å—Ç—å R&D'],
                    datasets: [{
                        label: '–¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (–¥–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è), %',
                        data: [current.roi, current.churn, current.rdSuccess],
                        backgroundColor: [
                            'rgba(139, 0, 0, 0.7)',
                            'rgba(165, 42, 42, 0.7)',
                            'rgba(178, 34, 34, 0.7)'
                        ],
                        borderColor: '#8B0000',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            title: { display: true, text: '–ü—Ä–æ—Ü–µ–Ω—Ç—ã (%)' }
                        },
                        x: { grid: { display: false } }
                    }
                }
            });
        }
        
        function createDecisionTimeChart() {
            const ctx = document.getElementById('decisionTimeChart').getContext('2d');
            const current = calculatedResults.current;
            
            charts.decisionTimeChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['–í—Ä–µ–º—è –ø—Ä–∏–Ω—è—Ç–∏—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π'],
                    datasets: [{
                        label: '–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–¥–Ω–µ–π)',
                        data: [current.decisionTime],
                        backgroundColor: ['rgba(205, 92, 92, 0.7)'],
                        borderColor: '#8B0000',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            title: { display: true, text: '–î–Ω–∏' }
                        },
                        x: { grid: { display: false } }
                    }
                }
            });
        }
        
        function createLTVChart() {
            const ctx = document.getElementById('ltvChart').getContext('2d');
            const clients = Math.min(companyData.parameters.keyClients.value, 8);
            
            const ltvData = Array.from({length: Math.max(5, clients)}, (_, i) => ({
                client: `–ö–ª–∏–µ–Ω—Ç ${i+1}`,
                current: calculatedResults.current.avgLtv * (0.7 + Math.random() * 0.6),
                predicted: calculatedResults.improved.avgLtv * (0.8 + Math.random() * 0.4)
            }));
            
            charts.ltvChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ltvData.map(d => d.client),
                    datasets: [
                        {
                            label: '–¢–µ–∫—É—â–∏–π LTV, –º–ª–Ω ‚ÇΩ',
                            data: ltvData.map(d => d.current),
                            borderColor: '#8B0000',
                            backgroundColor: 'rgba(139, 0, 0, 0.1)',
                            borderWidth: 2,
                            tension: 0.3
                        },
                        {
                            label: '–ü—Ä–æ–≥–Ω–æ–∑ LightGBM, –º–ª–Ω ‚ÇΩ',
                            data: ltvData.map(d => d.predicted),
                            borderColor: '#008000',
                            backgroundColor: 'rgba(0, 128, 0, 0.1)',
                            borderWidth: 2,
                            tension: 0.3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            title: { display: true, text: 'LTV, –º–ª–Ω ‚ÇΩ' }
                        },
                        x: { grid: { display: false } }
                    }
                }
            });
        }
        
        function createQlearningChart() {
            const ctx = document.getElementById('qlearningChart').getContext('2d');
            const episodes = Array.from({length: 20}, (_, i) => i + 1);
            const rewards = episodes.map(ep => 
                70 * (1 - Math.exp(-ep/5)) + 
                20 * (1 - Math.exp(-ep/10)) + 
                10 * (1 - Math.exp(-ep/15))
            );
            
            charts.qlearningChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: episodes.map(e => `–≠–ø. ${e}`),
                    datasets: [{
                        label: '–ö–æ–º–ø–æ–∑–∏—Ç–Ω–æ–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ (—Ñ–∏–Ω–∞–Ω—Å—ã 70% / –ø–∞—Ç–µ–Ω—Ç—ã 20% / –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏ 10%)',
                        data: rewards,
                        borderColor: '#ff9800',
                        backgroundColor: 'rgba(255, 152, 0, 0.1)',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            title: { display: true, text: '–í–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ' }
                        },
                        x: { 
                            grid: { display: false },
                            title: { display: true, text: '–≠–ø–∏–∑–æ–¥—ã –æ–±—É—á–µ–Ω–∏—è' }
                        }
                    }
                }
            });
        }
        
        function createComparisonPercentageChart() {
            const ctx = document.getElementById('comparisonPercentageChart').getContext('2d');
            const current = calculatedResults.current;
            const improved = calculatedResults.improved;
            
            charts.comparisonPercentageChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['ROI, %', '–û—Ç—Ç–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤, %', '–£—Å–ø–µ—à–Ω–æ—Å—Ç—å R&D, %'],
                    datasets: [
                        {
                            label: '–î–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è (2024)',
                            data: [current.roi, current.churn, current.rdSuccess],
                            backgroundColor: 'rgba(139, 0, 0, 0.7)',
                            borderColor: '#8B0000',
                            borderWidth: 1
                        },
                        {
                            label: '–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è (2025)',
                            data: [improved.roi, improved.churn, improved.rdSuccess],
                            backgroundColor: 'rgba(0, 128, 0, 0.7)',
                            borderColor: '#008000',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            title: { display: true, text: '–ü—Ä–æ—Ü–µ–Ω—Ç—ã (%)' }
                        },
                        x: { grid: { display: false } }
                    }
                }
            });
        }
        
        function createComparisonTimeChart() {
            const ctx = document.getElementById('comparisonTimeChart').getContext('2d');
            const current = calculatedResults.current;
            const improved = calculatedResults.improved;
            
            charts.comparisonTimeChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['–í—Ä–µ–º—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π, –¥–Ω–µ–π'],
                    datasets: [
                        {
                            label: '–î–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è',
                            data: [current.decisionTime],
                            backgroundColor: 'rgba(139, 0, 0, 0.7)',
                            borderColor: '#8B0000',
                            borderWidth: 1
                        },
                        {
                            label: '–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è',
                            data: [improved.decisionTime],
                            backgroundColor: 'rgba(0, 128, 0, 0.7)',
                            borderColor: '#008000',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            title: { display: true, text: '–î–Ω–∏' }
                        },
                        x: { grid: { display: false } }
                    }
                }
            });
        }
        
        function createEconomicChart() {
            const ctx = document.getElementById('economicChart').getContext('2d');
            const economic = calculatedResults.economic;
            
            charts.economicChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['–†–æ—Å—Ç –¥–æ—Ö–æ–¥–æ–≤', '–°–Ω–∏–∂–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç R&D', '–°–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–µ–≤', 'HR-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è'],
                    datasets: [{
                        data: [
                            parseFloat(economic.revenueIncrease),
                            parseFloat(economic.costReduction),
                            parseFloat(economic.downtimeReduction),
                            parseFloat(economic.hrSavings || 0)
                        ],
                        backgroundColor: [
                            'rgba(0, 128, 0, 0.8)',
                            'rgba(255, 152, 0, 0.8)',
                            'rgba(33, 150, 243, 0.8)',
                            'rgba(156, 39, 176, 0.8)'
                        ],
                        borderColor: ['#008000', '#ff9800', '#2196F3', '#9c27b0'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${parseFloat(context.raw).toFixed(1)} –º–ª–Ω ‚ÇΩ`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function createLightGBMDetailChart() {
            const ctx = document.getElementById('lightgbmDetailChart').getContext('2d');
            
            charts.lightgbmDetailChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['–ß–∞—Å—Ç–æ—Ç–∞ –ø–æ–∫—É–ø–æ–∫', '–°—Ä–µ–¥–Ω–∏–π —á–µ–∫', '–î–∞–≤–Ω–æ—Å—Ç—å –ø–æ–∫—É–ø–∫–∏', '–û—Ç—Ä–∞—Å–ª—å –∫–ª–∏–µ–Ω—Ç–∞', 'NPS', '–ö–∞–Ω–∞–ª –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è'],
                    datasets: [{
                        label: '–í–∫–ª–∞–¥ –≤ –ø—Ä–æ–≥–Ω–æ–∑ LTV (SHAP-–∑–Ω–∞—á–µ–Ω–∏—è), %',
                        data: [42, 28, -15, 12, 22, 14],
                        backgroundColor: [
                            'rgba(0, 128, 0, 0.7)',
                            'rgba(0, 128, 0, 0.7)',
                            'rgba(139, 0, 0, 0.7)',
                            'rgba(0, 128, 0, 0.7)',
                            'rgba(0, 128, 0, 0.7)',
                            'rgba(0, 128, 0, 0.7)'
                        ],
                        borderColor: '#008000',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            title: { display: true, text: '–í–∫–ª–∞–¥ –≤ –ø—Ä–æ–≥–Ω–æ–∑, %' }
                        },
                        y: { grid: { display: false } }
                    }
                }
            });
        }
        
        function createAutoencoderChart() {
            const ctx = document.getElementById('autoencoderChart').getContext('2d');
            const anomalyData = Array.from({length: 100}, (_, i) => {
                const x = i / 10;
                let y = Math.sin(x) + 0.1 * Math.sin(5 * x);
                if (i > 70 && i < 85) y += 0.5;
                if (i > 20 && i < 25) y += 0.3;
                return y;
            });
            
            charts.autoencoderChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 100}, (_, i) => i),
                    datasets: [{
                        label: '–û—à–∏–±–∫–∞ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (–∞–Ω–æ–º–∞–ª–∏–∏)',
                        data: anomalyData,
                        borderColor: '#8B0000',
                        backgroundColor: 'rgba(139, 0, 0, 0.1)',
                        borderWidth: 2,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            title: { display: true, text: '–£—Ä–æ–≤–µ–Ω—å –∞–Ω–æ–º–∞–ª–∏–∏' }
                        },
                        x: {
                            grid: { display: false },
                            title: { display: true, text: '–í—Ä–µ–º—è, —á–∞—Å—ã' }
                        }
                    }
                }
            });
        }
        
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector(`.tab[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }
        
        function showLoading(show) {
            document.getElementById('loading').classList.toggle('active', show);
        }
        
        // –§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel
        function exportToExcel() {
            if (!companyData || !calculatedResults) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –∫–æ–º–ø–∞–Ω–∏–∏');
                return;
            }
            
            showLoading(true);
            
            try {
                const wb = XLSX.utils.book_new();
                
                // –õ–∏—Å—Ç 1: –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ –ê–∫—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è
                const infoData = [
                    ['–î–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏—è: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ —Å—Ñ–µ—Ä–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ò–ò', ''],
                    ['–û–±—ä–µ–∫—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è', companyData.name],
                    ['–ò–ù–ù', companyData.inn],
                    ['–ê–∫—Ç –≤–≤–æ–¥–∞ –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é', '01.12.2025'],
                    ['–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ LTV (R¬≤)', '0.89'],
                    ['–ì–æ–¥–æ–≤–æ–π —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç', '26 –º–ª–Ω ‚ÇΩ'],
                    ['–ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ', '14 –º–ª–Ω ‚ÇΩ'],
                    ['–°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏', '6.5 –º–µ—Å—è—Ü–µ–≤ (–º–µ–Ω–µ–µ 7)'],
                    [],
                    ['–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–ø–∞–Ω–∏–∏', '–ó–Ω–∞—á–µ–Ω–∏–µ', '–ï–¥. –∏–∑–º.'],
                    ['–ì–æ–¥–æ–≤–∞—è –≤—ã—Ä—É—á–∫–∞', companyData.parameters.annualRevenue.value, '–º–ª–Ω ‚ÇΩ'],
                    ['–ë—é–¥–∂–µ—Ç R&D', companyData.parameters.rdBudget.value, '–º–ª–Ω ‚ÇΩ'],
                    ['–ö–ª—é—á–µ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã', companyData.parameters.keyClients.value, '—à—Ç'],
                    ['R&D –ø—Ä–æ–µ–∫—Ç—ã', companyData.parameters.rdProjects.value, '—à—Ç']
                ];
                
                const ws1 = XLSX.utils.aoa_to_sheet(infoData);
                XLSX.utils.book_append_sheet(wb, ws1, '–í–Ω–µ–¥—Ä–µ–Ω–∏–µ');
                
                // –õ–∏—Å—Ç 2: –ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (—Å—Ç—Ä–æ–≥–æ –ø–æ –í–ö–†)
                const current = calculatedResults.current;
                const improved = calculatedResults.improved;
                
                const metricsData = [
                    ['–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å', '–î–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è', '–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è', '–ò–∑–º–µ–Ω–µ–Ω–∏–µ'],
                    ['ROI –ø–æ—Ä—Ç—Ñ–µ–ª—è', '15%', '21%', '+6%'],
                    ['–û—Ç—Ç–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤', '10%', '7%', '-3%'],
                    ['–£—Å–ø–µ—à–Ω–æ—Å—Ç—å R&D –ø—Ä–æ–µ–∫—Ç–æ–≤', '40%', '65%', '+25%'],
                    ['–í—Ä–µ–º—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π', '28 –¥–Ω–µ–π', '10 –¥–Ω–µ–π', '-18 –¥–Ω–µ–π'],
                    ['–°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ R&D', '24 –º–µ—Å', '19 –º–µ—Å', '-5 –º–µ—Å'],
                    ['–°—Ä–µ–¥–Ω–∏–π LTV', `${current.avgLtv} –º–ª–Ω ‚ÇΩ`, `${improved.avgLtv} –º–ª–Ω ‚ÇΩ`, `+${calculatedResults.ltvData.improvement}%`]
                ];
                
                const ws2 = XLSX.utils.aoa_to_sheet(metricsData);
                XLSX.utils.book_append_sheet(wb, ws2, '–ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏');
                
                // –õ–∏—Å—Ç 3: –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç (–ø—Ä–æ–ø–∏—Å—å—é)
                const eco = calculatedResults.economic;
                const economicData = [
                    ['–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç', '–ó–Ω–∞—á–µ–Ω–∏–µ'],
                    ['–ì–æ–¥–æ–≤–æ–π —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç', '–¥–≤–∞–¥—Ü–∞—Ç—å —à–µ—Å—Ç—å –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Ä—É–±–ª–µ–π (26 –º–ª–Ω ‚ÇΩ)'],
                    ['–ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã', '—á–µ—Ç—ã—Ä–Ω–∞–¥—Ü–∞—Ç—å –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Ä—É–±–ª–µ–π (14 –º–ª–Ω ‚ÇΩ)'],
                    ['–°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏', '–º–µ–Ω–µ–µ —Å–µ–º–∏ –º–µ—Å—è—Ü–µ–≤ (6,5 –º–µ—Å.)'],
                    ['–°—Ç–∞—Ç—É—Å', '–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–∞—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —Å 01.12.2025']
                ];
                
                const ws3 = XLSX.utils.aoa_to_sheet(economicData);
                XLSX.utils.book_append_sheet(wb, ws3, '–≠–∫–æ–Ω–æ–º–∏–∫–∞');
                
                const fileName = `VKR_MobileParkIT_${new Date().toISOString().split('T')[0]}.xlsx`;
                XLSX.writeFile(wb, fileName);
                
                showLoading(false);
                alert('Excel –æ—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –≤ Excel:', error);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Excel —Ñ–∞–π–ª–∞');
                showLoading(false);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ PDF
        async function exportToPDF() {
            if (!companyData || !calculatedResults) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –∫–æ–º–ø–∞–Ω–∏–∏');
                return;
            }
            
            showLoading(true);
            
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'pt', 'a4');
                
                let yPos = 40;
                
                // –ó–ê–ì–û–õ–û–í–û–ö
                pdf.setFontSize(18);
                pdf.setTextColor(139, 0, 0);
                pdf.text('–ú–∞–≥–∏—Å—Ç–µ—Ä—Å–∫–∞—è –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏—è', 40, yPos);
                yPos += 20;
                pdf.setFontSize(16);
                pdf.text('–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ —Å—Ñ–µ—Ä–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π', 40, yPos);
                yPos += 25;
                
                pdf.setFontSize(14);
                pdf.text('–û–û–û ¬´–ú–æ–±–∞–π–ª –ü–∞—Ä–∫ –ò–¢¬ª: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è', 40, yPos);
                yPos += 30;
                
                // –ê–ö–¢ –í–ù–ï–î–†–ï–ù–ò–Ø
                pdf.setFontSize(12);
                pdf.setTextColor(0, 100, 0);
                pdf.text('‚úì –ê–∫—Ç –≤–≤–æ–¥–∞ –≤ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—É—é —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é –æ—Ç 01.12.2025', 40, yPos);
                yPos += 20;
                pdf.text('‚úì R¬≤ = 0.89 (–º–æ–¥–µ–ª—å –ø—Ä–æ–≥–Ω–æ–∑–∞ LTV)', 40, yPos);
                yPos += 20;
                pdf.text('‚úì –†–µ—à–µ–Ω–∏–µ —Ç–∏—Ä–∞–∂–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ —Ö–æ–ª–¥–∏–Ω–≥–∞', 40, yPos);
                yPos += 30;
                
                pdf.setTextColor(0, 0, 0);
                pdf.setDrawColor(139, 0, 0);
                pdf.line(40, yPos, 550, yPos);
                yPos += 30;
                
                // –ü–û–ö–ê–ó–ê–¢–ï–õ–ò
                pdf.setFontSize(14);
                pdf.setTextColor(139, 0, 0);
                pdf.text('–ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã', 40, yPos);
                yPos += 25;
                
                pdf.setFontSize(11);
                pdf.setTextColor(0, 0, 0);
                
                pdf.text('ROI –ø–æ—Ä—Ç—Ñ–µ–ª—è:', 40, yPos);
                pdf.text('15% ‚Üí 21%', 200, yPos);
                pdf.setTextColor(0, 128, 0);
                pdf.text('+6%', 300, yPos);
                yPos += 20;
                
                pdf.setTextColor(0, 0, 0);
                pdf.text('–û—Ç—Ç–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤:', 40, yPos);
                pdf.text('10% ‚Üí 7%', 200, yPos);
                pdf.setTextColor(0, 128, 0);
                pdf.text('-3%', 300, yPos);
                yPos += 20;
                
                pdf.setTextColor(0, 0, 0);
                pdf.text('–£—Å–ø–µ—à–Ω–æ—Å—Ç—å R&D –ø—Ä–æ–µ–∫—Ç–æ–≤:', 40, yPos);
                pdf.text('40% ‚Üí 65%', 200, yPos);
                pdf.setTextColor(0, 128, 0);
                pdf.text('+25%', 300, yPos);
                yPos += 20;
                
                pdf.setTextColor(0, 0, 0);
                pdf.text('–í—Ä–µ–º—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π:', 40, yPos);
                pdf.text('28 –¥–Ω–µ–π ‚Üí 10 –¥–Ω–µ–π', 200, yPos);
                pdf.setTextColor(0, 128, 0);
                pdf.text('-18 –¥–Ω–µ–π', 300, yPos);
                yPos += 20;
                
                pdf.setTextColor(0, 0, 0);
                pdf.text('–°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ R&D:', 40, yPos);
                pdf.text('24 –º–µ—Å. ‚Üí 19 –º–µ—Å.', 200, yPos);
                pdf.setTextColor(0, 128, 0);
                pdf.text('-5 –º–µ—Å.', 300, yPos);
                yPos += 30;
                
                // –≠–ö–û–ù–û–ú–ò–ö–ê
                pdf.setFontSize(14);
                pdf.setTextColor(139, 0, 0);
                pdf.text('–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç', 40, yPos);
                yPos += 25;
                
                pdf.setFontSize(11);
                pdf.setTextColor(0, 0, 0);
                
                pdf.text('–ì–æ–¥–æ–≤–æ–π —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç:', 40, yPos);
                pdf.text('26 –º–ª–Ω ‚ÇΩ', 200, yPos);
                yPos += 20;
                
                pdf.text('–ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ:', 40, yPos);
                pdf.text('14 –º–ª–Ω ‚ÇΩ', 200, yPos);
                yPos += 20;
                
                pdf.text('–°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏:', 40, yPos);
                pdf.text('–º–µ–Ω–µ–µ 7 –º–µ—Å—è—Ü–µ–≤', 200, yPos);
                yPos += 30;
                
                pdf.setFontSize(12);
                pdf.setTextColor(139, 0, 0);
                pdf.text('–¢—Ä–µ—Ö–∫–æ–Ω—Ç—É—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∞ –≤ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—É—é —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é', 40, yPos);
                yPos += 20;
                pdf.text('–ò–Ω–¥–µ–∫—Å –∑—Ä–µ–ª–æ—Å—Ç–∏ –ò–ò —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–æ–π –∫–æ–º–∞–Ω–¥—ã: ¬´–í—ã—Å–æ–∫–∏–π¬ª', 40, yPos);
                
                const fileName = `VKR_MobileParkIT_Results_${new Date().toISOString().split('T')[0]}.pdf`;
                pdf.save(fileName);
                
                showLoading(false);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –≤ PDF:', error);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PDF —Ñ–∞–π–ª–∞');
                showLoading(false);
            }
        }
    </script>
</body>
</html>
